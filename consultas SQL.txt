--1- Devuelve todas las películas
SELECT MOVIE_NAME FROM MOVIES
--2- Devuelve todos los géneros existentes
SELECT GENRE_NAME FROM GENRES
--3- Devuelve la lista de todos los estudios de grabación que estén activos
SELECT STUDIO_ACTIVE FROM STUDIOS
--4- Devuelve una lista de los 20 últimos miembros en anotarse a la plataforma
SELECT*FROM USERS ORDER BY USER_SUBSCRIPTION_ID DESC LIMIT 20
--5- Devuelve las 20 duraciones de películas más frecuentes, ordenados de mayor a menor
SELECT MOVIE_DURATION, COUNT (*) AS FRECUENCY FROM MOVIES GROUP BY MOVIE_DURATION ORDER BY FRECUENCY DESC, MOVIE_DURATION DESC LIMIT 20;
--6- Devuelve las películas del año 2000 en adelante que empiecen por la letra A.
SELECT * FROM MOVIES WHERE YEAR (MOVIE_RELEASE_DATE) >=2000 AND MOVIE_NAME LIKE 'A%'
--7- Devuelve los actores nacidos un mes de Junio
SELECT * FROM ACTORS WHERE MONTH (ACTOR_BIRTH_DATE) =06
--8- Devuelve los actores nacidos cualquier mes que no sea Junio y que sigan vivos
SELECT * FROM ACTORS WHERE MONTH (ACTOR_BIRTH_DATE) <> 06 AND ACTOR_DEAD_DATE IS  NULL
--9- Devuelve el nombre y la edad de todos los directores menores o iguales de 50 años que estén vivos
SELECT director_name, YEAR(CURRENT_DATE) - YEAR(director_birth_date) AS AGE FROM DIRECTORS WHERE DIRECTOR_DEAD_DATE IS NULL AND (YEAR(CURRENT_DATE) - YEAR(DIRECTOR_BIRTH_DATE)) <= 50;
--10- Devuelve el nombre y la edad de todos los actores menores de 50 años que hayan fallecido
SELECT DIRECTOR_NAME, YEAR (CURRENT_DATE) - YEAR (DIRECTOR_BIRTH_DATE) AS AGE FROM DIRECTORS WHERE DIRECTOR_DEAD_DATE IS NOT NULL AND (YEAR (CURRENT_DATE) - YEAR (DIRECTOR_BIRTH_DATE)) >=50;
--11- Devuelve el nombre de todos los directores menores o iguales de 40 años que estén vivos
SELECT DIRECTOR_NAME FROM DIRECTORS WHERE DIRECTOR_DEAD_DATE IS NULL AND (YEAR (CURRENT_DATE) - YEAR (DIRECTOR_BIRTH_DATE)) >=40
--12- Indica la edad media de los directores vivos
SELECT AVG (YEAR (CURRENT_DATE) - YEAR (DIRECTOR_BIRTH_DATE)) AS MIDDLE_AGE FROM DIRECTORS WHERE DIRECTOR_DEAD_DATE IS NULL
--13- Indica la edad media de los actores que han fallecido
SELECT AVG (YEAR (DIRECTOR_DEAD_DATE) - YEAR (DIRECTOR_BIRTH_DATE)) AS MIDDLE_AGE FROM DIRECTORS WHERE DIRECTOR_DEAD_DATE IS NOT NULL
--14- Devuelve el nombre de todas las películas y el nombre del estudio que las ha realizado
SELECT m.MOVIE_NAME, s.studio_name FROM MOVIES m JOIN STUDIOS S ON m.STUDIO_ID = s.STUDIO_ID
--15- Devuelve los miembros que accedieron al menos una película entre el año 2010 y el 2015

--16- Devuelve cuantas películas hay de cada país

--17- Devuelve todas las películas que hay de género documental
SELECT m.MOVIE_NAME FROM MOVIES m JOIN GENRES g ON m.GENRE_ID = g.GENRE_ID  WHERE g.GENRE_NAME = 'Documentary'
--18- Devuelve todas las películas creadas por directores nacidos a partir de 1980 y que todavía están vivos
SELECT m. MOVIE_NAME FROM MOVIES m JOIN DIRECTORS d ON m.DIRECTOR_ID = d.DIRECTOR_ID WHERE YEAR (d.DIRECTOR_BIRTH_DATE)>1980 AND d.DIRECTOR_DEAD_DATE IS NULL
--19- Indica si hay alguna coincidencia de nacimiento de ciudad (y si las hay, indicarlas) entre los miembros de la plataforma y los directores

--20- Devuelve el nombre y el año de todas las películas que han sido producidas por un estudio que actualmente no esté activo
SELECT m.MOVIE_NAME, strftime('%Y', m.MOVIE_RELEASE_DATE) AS YEAR FROM MOVIES m JOIN STUDIOS s ON m. STUDIO_ID = s. STUDIO_ID WHERE s. STUDIO_ACTIVE = 0
